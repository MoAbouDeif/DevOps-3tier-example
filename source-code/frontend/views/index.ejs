<%- include('partials/header', { title: title, currentPage: currentPage }) %>

        <!-- Calculator Tab -->
        <form id="calculatorForm" method="POST" action="/calculate">
            <% if (typeof error !== 'undefined' && error) { %>
                <div class="response error">
                    <i class="fas fa-exclamation-circle me-2"></i>
                    <%= error %>
                </div>
            <% } %>
            
            <div class="form-group">
                <label for="a"><i class="fas fa-number"></i> First Number</label>
                <div class="input-icon">
                    <i class="fas fa-1"></i>
                </div>
                <input 
                    type="number" 
                    id="a" 
                    name="a" 
                    class="form-control" 
                    placeholder="Enter first number" 
                    step="any"
                    value="<%= typeof calculation !== 'undefined' && calculation && calculation.a ? calculation.a : '' %>"
                    required
                >
            </div>
            
            <div class="form-group">
                <label for="b"><i class="fas fa-number"></i> Second Number</label>
                <div class="input-icon">
                    <i class="fas fa-2"></i>
                </div>
                <input 
                    type="number" 
                    id="b" 
                    name="b" 
                    class="form-control" 
                    placeholder="Enter second number" 
                    step="any"
                    value="<%= typeof calculation !== 'undefined' && calculation && calculation.b ? calculation.b : '' %>"
                    required
                >
            </div>
            
            <div class="form-group">
                <label><i class="fas fa-operations"></i> Operation</label>
                <input type="hidden" id="operation" name="operation" value="<%= typeof calculation !== 'undefined' && calculation && calculation.operation ? calculation.operation : '' %>">
                
                <div class="operation-grid">
                    <button type="button" class="operation-btn" data-operation="add">
                        <i class="fas fa-plus"></i> Add
                    </button>
                    <button type="button" class="operation-btn" data-operation="subtract">
                        <i class="fas fa-minus"></i> Subtract
                    </button>
                    <button type="button" class="operation-btn" data-operation="multiply">
                        <i class="fas fa-times"></i> Multiply
                    </button>
                    <button type="button" class="operation-btn" data-operation="divide">
                        <i class="fas fa-divide"></i> Divide
                    </button>
                </div>
            </div>
            
            <button type="submit" class="calculate-btn">
                <i class="fas fa-equals"></i> Calculate
            </button>
        </form>
        
        <% if (typeof result !== 'undefined' && result !== null) { %>
            <div class="result-card">
                <h3 class="result-label">Calculation Result</h3>
                <div class="result-value"><%= result %></div>
                <p class="result-calculation">
                    <%= calculation && calculation.a %> 
                    <%= getOperationSymbol(calculation && calculation.operation) %> 
                    <%= calculation && calculation.b %> 
                    = <strong><%= result %></strong>
                </p>
                
                <% if (typeof calculation !== 'undefined' && calculation && calculation.id) { %>
                    <div class="mt-3 d-flex gap-2 justify-content-center">
                        <form action="/calculation/<%= calculation.id %>/delete" method="POST" class="delete-form">
                            <button type="submit" class="delete-btn">
                                <i class="fas fa-trash me-1"></i> Delete
                            </button>
                        </form>
                        <a href="/history" class="btn btn-outline-primary btn-sm">
                            <i class="fas fa-history me-1"></i> History
                        </a>
                    </div>
                <% } %>
            </div>
        <% } %>

<%- include('partials/footer') %>

<script>
    // Select operation button if we have a previous operation
    <% if (typeof calculation !== 'undefined' && calculation && calculation.operation) { %>
        document.addEventListener('DOMContentLoaded', function() {
            const operationBtn = document.querySelector(`.operation-btn[data-operation="<%= calculation.operation %>"]`);
            if (operationBtn) {
                operationBtn.classList.add('selected');
                document.getElementById('operation').value = '<%= calculation.operation %>';
            }
        });
    <% } %>
</script>